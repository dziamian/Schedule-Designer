<div *ngIf="!loading && connectionStatus; else spinner" class="content">
    <mat-tab-group mat-align-tabs="center"
        animationDuration="0ms" 
        ([selectedIndex])="currentTabIndex"
        (selectedIndexChange)="OnTabChange($event)"
    >
        <mat-tab *ngFor="let label of tabLabels; let tabIndex = index" label="{{label}}">
            <ng-template matTabContent>
                <div *ngIf="!tabLoading && connectionStatus; else spinner" class="tabContent">
                    <span class="move-description"
                        [style.color]="isMoveValid ? 'green' : '#FF4800'">
                        <b>{{(isMoveValid) ? 'This move is possible!' : 
                            ((isMoveValid != null) ? 'This move is not possible, will be scheduled!' : '')}}</b>
                        <br>
                    </span>
                    <div class="board">
                        <div class="my-courses">
                            <div class="my-courses-header">Your unplanned courses</div>
                            <div class="my-courses-content"
                                cdkDropList
                                #myCoursesSlot="cdkDropList"
                                id="my-courses"
                                [cdkDropListData]="myCourses"
                                [cdkDropListSortingDisabled]="true"
                                (cdkDropListEntered)="OnMyCoursesEnter($event)"
                                (cdkDropListDropped)="DropInMyCourses($event)"
                            >
                                <div *ngFor="let course of myCourses" 
                                    class="course-field"
                                >
                                    <app-course 
                                        [course]="course"
                                        [settings]="settings"
                                        (start)="OnStartDragging($event)"
                                        (release)="OnReleaseDragging($event)"
                                    ></app-course>
                                </div>
                            </div>
                        </div>
                        <div class="schedule">
                            <div class="schedule-header">Schedule</div>
                            <div class="schedule-content" cdkScrollable>
                                <table>
                                    <thead>
                                        <tr>
                                            <th class="day-column"></th>
                                            <th *ngFor="let timeLabel of scheduleTimeLabels">
                                                {{timeLabel}}
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr *ngFor="let dayLabel of scheduleDayLabels; let dayIndex = index">
                                            <td class="day-column">
                                                <b>{{dayLabel}}</b>
                                            </td>
                                            <td *ngFor="let timeLabel of scheduleTimeLabels; let timeIndex = index"
                                                cdkDropList
                                                #scheduleSlots="cdkDropList"
                                                id="{{dayIndex}},{{timeIndex}}"
                                                cdkDropListSortingDisabled
                                                [cdkDropListData]="schedule[dayIndex][timeIndex]"
                                                [cdkDropListEnterPredicate]="ScheduleSlotEnterPredicate"
                                                [cdkDropListDisabled]="IsScheduleSlotDisabled(dayIndex,timeIndex)"
                                                (cdkDropListEntered)="OnScheduleSlotEnter($event)"
                                                (cdkDropListDropped)="DropInSchedule($event)"

                                                [attr.valid]="scheduleSlotsValidity[dayIndex][timeIndex]"
                                                [attr.current]="this.currentDragEvent?.source?.dropContainer?.id === dayIndex + ',' + timeIndex"
                                                [attr.course]="true"
                                            >
                                                <div *ngFor="let course of schedule[dayIndex][timeIndex]; let courseIndex = index" 
                                                    class="schedule-course-field"
                                                    [style.border-bottom]="courseIndex == GetMaxElementIndexOnDay(dayIndex) ? 'none' : ''"
                                                >
                                                    <app-course 
                                                        [course]="course"
                                                        [settings]="settings"
                                                        [weeksOnTab]="weeks[currentTabIndex]"
                                                        (start)="OnStartDragging($event)"
                                                        (release)="OnReleaseDragging($event)"
                                                        
                                                        [ngClass]="{'not-grabbing': IsScheduleSlotDisabled(dayIndex, timeIndex)}"
                                                    ></app-course>
                                                </div>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </ng-template>
        </mat-tab>
    </mat-tab-group>
</div>
<ng-template #spinner>
    <mat-progress-spinner
        class="spinner"
        mode="indeterminate"
        diameter="40"
    ></mat-progress-spinner>
</ng-template>